import os

class Scanner:
    """
    A class to invoke Trivy container scanning
 
    Attributes:
        scanner_results_directory (str): string representation of the directory where trivy's raw results are stored
    """
    
    def __init__(self, scanner_results_directory: str = 'scanner_results_trivy_raw') -> None:
        self.scanner_results_directory = scanner_results_directory
    
    def scanner(self, container_name: str) -> None:
        """
        Entry method to use Trivy to scan specified container. In this implementation, only Docker Hub can be used to scan container
 
        Parameters:
            container_name (str): string representation of container that Trivy should scan
 
        Returns:
            None: writes result from Trivy for specified container to scanner_results_directory in class
        """
        os.system(f'trivy image -f json -o {self.scanner_results_directory}/{container_name}.json {container_name}')

if __name__ == '__main__':
    pass
