import json

class GetResults:
    """
    A class to get the container scanning results
 
    Attributes:
        scanner_results_directory_processed (str): string representation of the directory of where to store the processed data
    """

    def __init__(self, scanner_results_directory_processed: str = 'scanner_results_processed'):
        self.scanner_results_directory_processed = scanner_results_directory_processed
    
    def get_results(self, container_name: str) -> dict:
        """
        Method for getting processed vulnerability records
 
        Parameters:
            container_name (str): string representation of the container name you want results for
 
        Returns:
            dict: dictionary representing the container scanning results - if results not found return {'result': No container scan results for: container_name}
        """
        try:
            with open(f'{self.scanner_results_directory_processed}/{container_name}.json') as file:
                json_data = json.load(file)
            return json_data
        except FileNotFoundError:
            return {'result': f'No container scan results for: {container_name}'}
