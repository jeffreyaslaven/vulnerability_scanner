import requests

class EPSS:
    """
    A class used for enriching data from Trivy with EPSS data
 
    Attributes:
        epss_endpoint (str): The base url for the EPSS API.
    """

    def __init__(self, epss_endpoint='https://api.first.org/data/v1/epss?cve=') -> None:
        self.epss_endpoint = epss_endpoint
        self.session = requests.Session()
    
    def enrich_results(self, vulnerability_id: str):
        """
        Uses the initialized EPSS endpoint and the passed vulnerability_id to call the EPSS API
 
        Parameters:
            vulnerability_id (str): CVE(s) id(s) represented as a string
 
        Returns:
            dict: returns the EPSS endpoint response
        """
        try:
            return self.session.get(f'{self.epss_endpoint}{vulnerability_id}').json()
        except:
            return None

if __name__ == '__main__':
   pass